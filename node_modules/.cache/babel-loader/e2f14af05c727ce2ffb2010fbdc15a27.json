{"ast":null,"code":"var _jsxFileName = \"/Users/mathieujoly/Documents/Next_THP/Semaine07/J31/the-K/src/pages/Login/Login.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport Cookies from 'js-cookie';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setID, setName } from 'actions';\nimport { useHistory } from 'react-router-dom';\nimport jwt_decode from \"jwt-decode\";\nimport { Link } from 'react-router-dom';\nimport './Login.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Login = () => {\n  _s();\n\n  const dispatch = useDispatch();\n  const [displayError, setDisplayError] = useState('');\n  const {\n    register,\n    handleSubmit,\n    watch,\n    errors\n  } = useForm();\n  const history = useHistory();\n\n  const onSubmit = data => {\n    fetch('http://localhost:1337/auth/local', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    }).then(response => response.json()).then(response => {\n      dispatch(setID(response.user.id));\n      dispatch(setName(response.user.username));\n      Cookies.set('token', response.jwt);\n      history.push(\"/\");\n    }).catch(error => setDisplayError('Mauvais identifiant / password'));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"Login\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit(onSubmit),\n      className: \"Register\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"identifier\",\n        type: \"email\",\n        placeholder: \"email\",\n        ref: register({\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 37,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        name: \"password\",\n        type: \"password\",\n        placeholder: \"password\",\n        ref: register({\n          required: true\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 38,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"submit\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 39,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: displayError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 40,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/register\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Register\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 14\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 35,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Login, \"+nGltm6pkYvnZNsNYygkwQqYItI=\", false, function () {\n  return [useDispatch, useForm, useHistory];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["/Users/mathieujoly/Documents/Next_THP/Semaine07/J31/the-K/src/pages/Login/Login.jsx"],"names":["React","useState","useForm","Cookies","useSelector","useDispatch","setID","setName","useHistory","jwt_decode","Link","Login","dispatch","displayError","setDisplayError","register","handleSubmit","watch","errors","history","onSubmit","data","fetch","method","headers","body","JSON","stringify","then","response","json","user","id","username","set","jwt","push","catch","error","required"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AACA,SAASC,OAAT,QAAwB,iBAAxB;AACA,OAAOC,OAAP,MAAoB,WAApB;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,KAAT,EAAgBC,OAAhB,QAA+B,SAA/B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,OAAO,cAAP;;;AAEA,MAAMC,KAAK,GAAG,MAAM;AAAA;;AACjB,QAAMC,QAAQ,GAAGP,WAAW,EAA5B;AACA,QAAM,CAACQ,YAAD,EAAeC,eAAf,IAAkCb,QAAQ,CAAC,EAAD,CAAhD;AACF,QAAM;AAAEc,IAAAA,QAAF;AAAYC,IAAAA,YAAZ;AAA0BC,IAAAA,KAA1B;AAAiCC,IAAAA;AAAjC,MAA4ChB,OAAO,EAAzD;AACA,QAAMiB,OAAO,GAAGX,UAAU,EAA1B;;AACE,QAAMY,QAAQ,GAAGC,IAAI,IAAI;AACxBC,IAAAA,KAAK,CAAC,kCAAD,EAAqC;AACxCC,MAAAA,MAAM,EAAE,MADgC;AAExCC,MAAAA,OAAO,EAAE;AACT,wBAAgB;AADP,OAF+B;AAKxCC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeN,IAAf;AALkC,KAArC,CAAL,CAODO,IAPC,CAOKC,QAAD,IAAcA,QAAQ,CAACC,IAAT,EAPlB,EAQDF,IARC,CAQKC,QAAD,IAAc;AACnBjB,MAAAA,QAAQ,CAACN,KAAK,CAACuB,QAAQ,CAACE,IAAT,CAAcC,EAAf,CAAN,CAAR;AACApB,MAAAA,QAAQ,CAACL,OAAO,CAACsB,QAAQ,CAACE,IAAT,CAAcE,QAAf,CAAR,CAAR;AACA9B,MAAAA,OAAO,CAAC+B,GAAR,CAAY,OAAZ,EAAqBL,QAAQ,CAACM,GAA9B;AACAhB,MAAAA,OAAO,CAACiB,IAAR,CAAa,GAAb;AACA,KAbC,EAcDC,KAdC,CAcMC,KAAD,IAAWxB,eAAe,CAAC,gCAAD,CAd/B;AAeA,GAhBD;;AAkBF,sBACC;AAAK,IAAA,SAAS,EAAC,OAAf;AAAA,2BACE;AAAM,MAAA,QAAQ,EAAEE,YAAY,CAACI,QAAD,CAA5B;AAAwC,MAAA,SAAS,EAAC,UAAlD;AAAA,8BACE;AAAO,QAAA,IAAI,EAAC,YAAZ;AAAyB,QAAA,IAAI,EAAC,OAA9B;AAAsC,QAAA,WAAW,EAAC,OAAlD;AAA0D,QAAA,GAAG,EAAEL,QAAQ,CAAC;AAAEwB,UAAAA,QAAQ,EAAE;AAAZ,SAAD;AAAvE;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAO,QAAA,IAAI,EAAC,UAAZ;AAAuB,QAAA,IAAI,EAAC,UAA5B;AAAuC,QAAA,WAAW,EAAC,UAAnD;AAA8D,QAAA,GAAG,EAAExB,QAAQ,CAAC;AAAEwB,UAAAA,QAAQ,EAAE;AAAZ,SAAD;AAA3E;AAAA;AAAA;AAAA;AAAA,cAFF,eAGI;AAAO,QAAA,IAAI,EAAC;AAAZ;AAAA;AAAA;AAAA;AAAA,cAHJ,eAII;AAAA,kBAAI1B;AAAJ;AAAA;AAAA;AAAA;AAAA,cAJJ,eAKI,QAAC,IAAD;AAAM,QAAA,EAAE,EAAC,WAAT;AAAA,+BACK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADL;AAAA;AAAA;AAAA;AAAA,cALJ;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UADD;AAcA,CArCD;;GAAMF,K;UACcN,W,EAE+BH,O,EAClCM,U;;;KAJXG,K;AAuCN,eAAeA,KAAf","sourcesContent":["import React, { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport Cookies from 'js-cookie'\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setID, setName } from 'actions';\nimport { useHistory } from 'react-router-dom';\nimport jwt_decode from \"jwt-decode\";\nimport { Link } from 'react-router-dom';\nimport './Login.scss';\n\nconst Login = () => {\n  \tconst dispatch = useDispatch();\n  \tconst [displayError, setDisplayError] = useState('');\n\tconst { register, handleSubmit, watch, errors } = useForm();\n\tconst history = useHistory();\n  \tconst onSubmit = data => {\n  \t\tfetch('http://localhost:1337/auth/local', {\n  \t\t  method: 'post',\n  \t\t  headers: {\n    \t\t'Content-Type': 'application/json'\n  \t\t  },\n  \t\t  body: JSON.stringify(data)\n\t\t})\n\t\t.then((response) => response.json())\n\t\t.then((response) => {\n\t\t\tdispatch(setID(response.user.id));\n\t\t\tdispatch(setName(response.user.username));\n\t\t\tCookies.set('token', response.jwt);\n\t\t\thistory.push(\"/\");\n\t\t})\n\t\t.catch((error) => setDisplayError('Mauvais identifiant / password'));\n  \t}\n\n\treturn (\n\t\t<div className='Login'>\n\t\t  <form onSubmit={handleSubmit(onSubmit)} className=\"Register\">\n\t\t    <input name=\"identifier\" type=\"email\" placeholder=\"email\" ref={register({ required: true })} />\n\t\t    <input name=\"password\" type=\"password\" placeholder=\"password\" ref={register({ required: true })} />\n\t  \t    <input type=\"submit\" />\n\t  \t    <p>{displayError}</p>\n\t  \t    <Link to=\"/register\">\n          \t  <p>Register</p>\n        \t</Link>\n\t      </form>\n\n\t    </div>\n\t);\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}