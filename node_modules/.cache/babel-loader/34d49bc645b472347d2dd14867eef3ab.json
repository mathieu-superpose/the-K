{"ast":null,"code":"var _jsxFileName = \"/Users/mathieujoly/Documents/Next_THP/Semaine07/J31/the-K/the-k/src/pages/Register/Register.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport Cookies from 'js-cookie';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setID } from 'actions';\nimport { useHistory } from 'react-router-dom';\nimport jwt_decode from \"jwt-decode\";\nimport './Register.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Register = () => {\n  _s();\n\n  const dispatch = useDispatch();\n  const [displayError, setDisplayError] = useState('');\n  const {\n    register,\n    handleSubmit,\n    watch,\n    errors\n  } = useForm();\n  const history = useHistory();\n\n  const onSubmit = data => {\n    // console.log(data);\n    fetch('http://localhost:1337/auth/local/register', {\n      method: 'post',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    }).then(response => response.json()).then(response => {\n      console.log(response);\n      dispatch(setID(response.user.id)); // console.log(jwt_decode(response.jwt))\n\n      Cookies.set('token', response.jwt);\n      history.push(\"/\");\n    }).catch(error => setDisplayError(response.data[0].messages[0].message));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit(onSubmit),\n    className: \"Register\",\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      name: \"username\",\n      type: \"text\",\n      placeholder: \"username\",\n      ref: register({\n        required: true\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      name: \"email\",\n      type: \"email\",\n      placeholder: \"email\",\n      ref: register({\n        required: true\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      name: \"password\",\n      type: \"password\",\n      placeholder: \"password\",\n      ref: register({\n        required: true\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"submit\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\"error: \", displayError]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 38,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Register, \"+nGltm6pkYvnZNsNYygkwQqYItI=\", false, function () {\n  return [useDispatch, useForm, useHistory];\n});\n\n_c = Register;\nexport default Register;\n\nvar _c;\n\n$RefreshReg$(_c, \"Register\");","map":{"version":3,"sources":["/Users/mathieujoly/Documents/Next_THP/Semaine07/J31/the-K/the-k/src/pages/Register/Register.jsx"],"names":["React","useState","useEffect","useForm","Cookies","useSelector","useDispatch","setID","useHistory","jwt_decode","Register","dispatch","displayError","setDisplayError","register","handleSubmit","watch","errors","history","onSubmit","data","fetch","method","headers","body","JSON","stringify","then","response","json","console","log","user","id","set","jwt","push","catch","error","messages","message","required"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport Cookies from 'js-cookie'\nimport { useSelector, useDispatch } from 'react-redux';\nimport { setID } from 'actions';\nimport { useHistory } from 'react-router-dom';\nimport jwt_decode from \"jwt-decode\";\nimport './Register.scss';\n\nconst Register = () => {\n  \tconst dispatch = useDispatch();\n  \tconst [displayError, setDisplayError] = useState('');\n\n\tconst { register, handleSubmit, watch, errors } = useForm();\n\tconst history = useHistory();\n\n  \tconst onSubmit = data => {\n  \t\t// console.log(data);\n  \t\tfetch('http://localhost:1337/auth/local/register', {\n  \t\t  method: 'post',\n  \t\t  headers: {\n    \t\t'Content-Type': 'application/json'\n  \t\t  },\n  \t\t  body: JSON.stringify(data)\n\t\t})\n\t\t.then((response) => response.json())\n\t\t.then((response) => {\n\t\t\tconsole.log(response);\n\t\t\tdispatch(setID(response.user.id));\n\t\t\t// console.log(jwt_decode(response.jwt))\n\t\t\tCookies.set('token', response.jwt);\n\t\t\thistory.push(\"/\");\n\t\t})\n\t\t.catch((error) => setDisplayError(response.data[0].messages[0].message));\n  \t}\n\n\treturn (\n\t\t<form onSubmit={handleSubmit(onSubmit)} className=\"Register\">\n\t\t  <input name=\"username\" type=\"text\" placeholder=\"username\" ref={register({ required: true })} />\n\t\t  <input name=\"email\" type=\"email\" placeholder=\"email\" ref={register({ required: true })} />\n\t\t  <input name=\"password\" type=\"password\" placeholder=\"password\" ref={register({ required: true })} />\n\t  \t  <input type=\"submit\" />\n\t  \t  <p>error: {displayError}</p>\n\t    </form>\n\t);\n};\n\nexport default Register;\n"]},"metadata":{},"sourceType":"module"}